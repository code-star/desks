(this["webpackJsonpdesks-client"]=this["webpackJsonpdesks-client"]||[]).push([[0],{152:function(e,t,n){},160:function(e,t,n){},161:function(e,t,n){},166:function(e,t,n){"use strict";n.r(t);var a=n(0),c=n.n(a),r=n(56),s=n.n(r),i=(n(152),n(248)),o=n(8),j=n(250),d=n(236),u=n(252),b=n(93),l=n.n(b),O=n(25),x=n.n(O),h=n(39),f=n(259),p=n(260),k=n(244),m=n(242),v=n(261),g=n(233),w=n(251),y=n(262),C=n(245),S=n(227),_=n(234),T=n(228),D=n(85),z=n(239),B=n(230),N=n(172),I=n(231),P=c.a.createContext(null),A=n(1),E=function(e){var t=e.title,n=e.type,c=Object(a.useContext)(P),r=Object(o.a)(c.startTime,2),s=r[0],i=r[1],d=Object(a.useContext)(P),u=Object(o.a)(d.endTime,2),b=u[0],l=u[1];return Object(A.jsxs)(j.a,{children:[Object(A.jsx)(w.a,{variant:"body1",gutterBottom:!0,children:t}),Object(A.jsx)(N.b,{dateAdapter:B.a,children:Object(A.jsx)(I.a,{value:"Start"===n?s:b,onChange:function(e){e&&("Start"===n&&i(e),"End"===n&&l(e))},renderInput:function(e){return Object(A.jsx)(z.a,Object(D.a)({},e))}})})]})};function H(e,t,n){return e>=t&&e<=n}function L(e,t){return new Date(e.getFullYear(),e.getMonth(),e.getDate(),t.getHours(),t.getMinutes()).getTime()/1e3}var F=function(e,t){return L(e,t)-Date.now()/1e3<=0},M=function(e){return""===e},J=function(e,t,n){var a=L(e,t);return L(e,n)-a<=0},G=function(){var e=Object(a.useContext)(P),t=Object(o.a)(e.date,1)[0],n=Object(o.a)(e.startTime,1)[0],c=Object(o.a)(e.endTime,1)[0];return Object(A.jsxs)(S.a,{spacing:2,children:[Object(A.jsx)(E,{title:"Please select the start time for the booking",type:"Start"}),F(t,n)?Object(A.jsx)(_.a,{severity:"warning",children:"Check if the time has passed"}):null,Object(A.jsx)(T.a,{}),Object(A.jsx)(E,{title:"Please select the end time for the booking",type:"End"}),J(t,n,c)?Object(A.jsx)(_.a,{severity:"warning",children:"The end time is earlier than the start time"}):null]})},K=n(243),U=function(e){return L(e,e)<Date.now()/1e3-86400},W=function(){var e=Object(a.useContext)(P),t=Object(o.a)(e.date,2),n=t[0],c=t[1];return Object(A.jsx)(N.b,{dateAdapter:B.a,children:Object(A.jsx)(K.a,{orientation:"portrait",displayStaticWrapperAs:"desktop",openTo:"day",value:n,shouldDisableDate:U,onChange:function(e){e&&c(e)},renderInput:function(e){return Object(A.jsx)(z.a,Object(D.a)({},e))}})})},Y=function(){return Object(A.jsxs)(j.a,{children:[Object(A.jsx)(w.a,{variant:"body1",gutterBottom:!0,children:"Please select the date for the booking"}),Object(A.jsx)(W,{})]})},Q=n(238),R=n(257),q=n(240),V=n(232),X=n(241),Z=function(){var e=Object(a.useState)([]),t=Object(o.a)(e,2),n=t[0],c=t[1],r=Object(a.useContext)(P),s=Object(o.a)(r.desk,2),i=s[0],j=s[1],d=Object(a.useContext)(P),u=Object(o.a)(d.startTime,1)[0],b=Object(a.useContext)(P),l=Object(o.a)(b.endTime,1)[0],O=Object(a.useContext)(P),f=Object(o.a)(O.date,1)[0],p=Object(a.useContext)(P),k=Object(o.a)(p.bookingSucces,1)[0];return Object(a.useEffect)((function(){var e=function(){var e=Object(h.a)(x.a.mark((function e(){var t,n,a,r,s,i,o;return x.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("".concat("https://ordina-smartdesk-api.azurewebsites.net/","api/bookinglist"));case 2:return t=e.sent,e.next=5,t.json();case 5:return n=e.sent,a=n.bookingList,r=a.filter((function(e){var t=L(f,u),n=L(f,l),a=H(e.start_time,t,n),c=H(e.end_time,t,n);return a||c})),e.next=10,fetch("".concat("https://ordina-smartdesk-api.azurewebsites.net/","api/desk/list"));case 10:return s=e.sent,e.next=13,s.json();case 13:i=e.sent,o=i.deskList.filter((function(e){return!r.find((function(t){return t.booked_desk===e.desk_id}))})),c(o);case 16:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();e()}),[k,l,u,f]),Object(A.jsxs)(R.a,{sx:{m:1,minWidth:120},children:[Object(A.jsx)(q.a,{children:"Desk"}),Object(A.jsx)(V.a,{value:i,label:"Desk",onChange:function(e){j(e.target.value)},children:n.map((function(e){return Object(A.jsx)(X.a,{value:e.desk_id,children:e.desk_id})}))})]})},$=n.p+"static/media/floor_plan_Ordina_B2.c52b3cd2.jpg",ee=(n(160),function(){var e=Object(a.useState)(!1),t=Object(o.a)(e,2),n=t[0],c=t[1],r=Object(a.useContext)(P),s=Object(o.a)(r.desk,1)[0];return Object(A.jsxs)("div",{children:[Object(A.jsxs)(k.a,{container:!0,spacing:1,children:[Object(A.jsxs)(k.a,{item:!0,xs:12,md:4,children:[Object(A.jsx)(w.a,{variant:"body1",gutterBottom:!0,children:"Please select one of the available desks:"}),Object(A.jsx)(Z,{}),M(s)?Object(A.jsx)(_.a,{severity:"warning",children:"There is no desk selected"}):""]}),Object(A.jsxs)(k.a,{item:!0,xs:12,md:8,children:[Object(A.jsx)("img",{className:"deskstep-image",onClick:function(){return c(!0)},src:$,alt:"Layout"}),Object(A.jsx)(w.a,{variant:"caption",children:"Click image to enlarge"})]})]}),Object(A.jsx)(Q.a,{open:n,onClose:function(){return c(!1)},children:Object(A.jsx)("img",{className:"deskstep-modal-content",alt:"zoomedLayout",src:$})})]})}),te=function(){var e=[Object(A.jsx)(Y,{}),Object(A.jsx)(G,{}),Object(A.jsx)(ee,{})],t=["Select booking date","Select booking time","Select desk"],n=Object(a.useContext)(P),c=Object(o.a)(n.activeStep,2),r=c[0],s=c[1],i=Object(o.a)(n.date,1)[0],j=Object(o.a)(n.startTime,1)[0],d=Object(o.a)(n.endTime,1)[0],u=Object(o.a)(n.desk,2),b=u[0],l=u[1],O=Object(o.a)(n.bookingSucces,2)[1],S=Object(o.a)(n.prevSelectedDesk,2)[1],_=function(){var e=Object(h.a)(x.a.mark((function e(){var t;return x.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("".concat("https://ordina-smartdesk-api.azurewebsites.net/","api/book"),{method:"PATCH",headers:{"Content-type":"application/json; charset=UTF-8"},body:JSON.stringify({booking_id:"booking ".concat(b,".").concat(Date.now()),start_time:L(i,j),end_time:L(i,d),booked_desk:b})});case 2:return t=e.sent,e.next=5,t.json();case 5:e.sent.booking&&(O(!0),S(b),l(""));case 7:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),T=function(){return D&&(M(b)||J(i,j,d)||F(i,j))},D=r===t.length-1,z=function(){D?_():s(r+1)},B=function(e){return 1===e&&F(i,j)||1===e&&J(i,j,d)||2===e&&M(b)};return Object(A.jsxs)(f.a,{elevation:6,className:"basecard",sx:{width:{xs:"100%",md:"900px"}},children:[Object(A.jsx)(p.a,{sx:{minHeight:{xs:"calc(100vh - 120px)",md:"580px"}},children:Object(A.jsxs)(k.a,{container:!0,spacing:5,children:[Object(A.jsx)(k.a,{item:!0,xs:6,md:12,children:Object(A.jsx)(m.a,{nonLinear:!0,activeStep:r,children:t.map((function(e,t){return Object(A.jsx)(v.a,{children:Object(A.jsxs)(g.a,{onClick:function(){s(t)},children:[Object(A.jsx)(w.a,{variant:"body1",children:e}),B(t)?Object(A.jsx)(w.a,{variant:"caption",color:"error",children:"Missing/ wrong information"}):null]})},e)}))})}),Object(A.jsx)(k.a,{item:!0,xs:12,children:e[r]}),Object(A.jsx)(k.a,{item:!0,xs:12})]})}),Object(A.jsxs)(y.a,{sx:{justifyContent:"flex-end"},children:[Object(A.jsx)(C.a,{disabled:0===r,onClick:function(){s(r-1)},children:"Back"}),D?Object(A.jsx)(C.a,{variant:"contained",onClick:z,disabled:T(),color:"secondary",children:"Book"}):Object(A.jsx)(C.a,{variant:"contained",onClick:z,disabled:T(),children:"Next"})]})]})},ne=function(){var e=new Date;e.setHours(9,0,0,0);var t=new Date;t.setHours(17,0,0,0);var n=Object(a.useState)(""),c=Object(o.a)(n,2),r=c[0],s=c[1],i=Object(a.useState)(0),b=Object(o.a)(i,2),O=b[0],x=b[1],h=Object(a.useState)(!1),f=Object(o.a)(h,2),p=f[0],k=f[1],m=Object(a.useState)(e),v=Object(o.a)(m,2),g=v[0],w=v[1],y=Object(a.useState)(t),C=Object(o.a)(y,2),S=C[0],_=C[1],T=Object(a.useState)(new Date(Date.now()+864e5)),D=Object(o.a)(T,2),z=D[0],B=D[1],N=Object(a.useState)(""),I=Object(o.a)(N,2),E={startTime:[g,w],endTime:[S,_],date:[z,B],desk:[I[0],I[1]],activeStep:[O,x],bookingSucces:[p,k],prevSelectedDesk:[r,s]};return Object(A.jsx)(P.Provider,{value:E,children:Object(A.jsxs)(j.a,{sx:{p:{xs:1,md:3},pt:{xs:3,md:3}},children:[Object(A.jsx)(te,{}),Object(A.jsx)(d.a,{anchorOrigin:{vertical:"top",horizontal:"center"},open:p,action:Object(A.jsx)(u.a,{onClick:function(){k(!1)},children:Object(A.jsx)(l.a,{color:"primary"})}),autoHideDuration:6e3,onClose:function(){k(!1)},message:"Your booking for desk ".concat(r," was succesful")})]})})},ae=n(263),ce=n(258),re=n(237),se=function(e){var t=e.desk;return Object(A.jsx)(re.a,{children:t.desk_id})},ie=function(e){return H(Date.now()/1e3,e.start_time-18e5,e.end_time)},oe=function(e){var t=e.deskId,n=Object(a.useState)([]),c=Object(o.a)(n,2),r=c[0],s=c[1];return Object(a.useEffect)((function(){var e=function(){var e=Object(h.a)(x.a.mark((function e(){var n,a,c,r,i,o,j,d,u,b;return x.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("".concat("https://ordina-smartdesk-api.azurewebsites.net/","api/desk/list"));case 2:return n=e.sent,e.next=5,n.json();case 5:return a=e.sent,c=a.deskList,e.next=9,fetch("".concat("https://ordina-smartdesk-api.azurewebsites.net/","api/bookinglist"));case 9:return r=e.sent,e.next=12,r.json();case 12:i=e.sent,o=i.bookingList,j=c.findIndex((function(e){return e.desk_id===t})),d=function(e){return c.find((function(t){return t.desk_id===e.booked_desk}))},(u=o.filter(ie).map(d)).find((function(e){return(null===e||void 0===e?void 0:e.desk_id)===t}))&&(b=c.filter((function(e,t){var n=u.find((function(t){return(null===t||void 0===t?void 0:t.desk_id)===e.desk_id})),a=j-t;return!(j===t)&&(a>=-2&&a<=2)&&!n})),s(b));case 18:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();e()}),[t]),Object(A.jsxs)(S.a,{children:[r.length<=0?"":"This desk is not available, but these are:",Object(A.jsx)(ce.a,{style:{maxHeight:200,overflow:"auto"},children:r.map((function(e){return Object(A.jsx)(se,{desk:e},e.desk_id)}))})]})},je=function(){var e=document.location.search.substr(1),t=Object(a.useState)("free"),n=Object(o.a)(t,2),c=n[0],r=n[1],s=Object(a.useState)(!1),i=Object(o.a)(s,2),b=i[0],O=i[1];Object(a.useEffect)((function(){var t=function(){var t=Object(h.a)(x.a.mark((function t(){var n,a;return x.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,fetch("".concat("https://ordina-smartdesk-api.azurewebsites.net/","api/desk/").concat(e));case 2:return n=t.sent,t.next=5,n.json();case 5:a=t.sent,r(a.deskState);case 7:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}();t()}),[e]);var k=function(){var t=Object(h.a)(x.a.mark((function t(){var n,a;return x.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,fetch("".concat("https://ordina-smartdesk-api.azurewebsites.net/","api/desk/").concat(e),{method:"PATCH",headers:{"Content-type":"application/json; charset=UTF-8"},body:JSON.stringify({deskState:c,deskId:e})});case 2:return n=t.sent,t.next=5,n.json();case 5:a=t.sent,r(a.deskState),O(!0);case 8:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}();return Object(A.jsxs)(j.a,{sx:{p:{xs:1,md:3},pt:{xs:3,md:3}},children:[Object(A.jsxs)(f.a,{elevation:6,className:"basecard",sx:{width:{xs:"100%",md:"900px"}},children:[Object(A.jsx)(ae.a,{title:"Desk ".concat(e)}),Object(A.jsx)(p.a,{children:Object(A.jsxs)(S.a,{spacing:2,children:[Object(A.jsx)(C.a,{variant:"contained",sx:{width:"200px"},color:"secondary",disabled:"unavailable"===c,onClick:k,children:"free"===c?"Check in":"Check out"}),Object(A.jsx)(T.a,{}),Object(A.jsx)(oe,{deskId:e})]})})]}),Object(A.jsx)(d.a,{anchorOrigin:{vertical:"top",horizontal:"center"},open:b,autoHideDuration:6e3,onClose:function(){O(!1)},action:Object(A.jsx)(u.a,{onClick:function(){return O(!1)},children:Object(A.jsx)(l.a,{color:"primary"})}),message:"free"===c?"checked out":"checked in"})]})},de=n(264),ue=n(265),be=n(123),le=n.n(be),Oe=n.p+"static/media/ordina_logo.7a9a0777.png",xe=function(){return Object(A.jsx)(de.a,{position:"static",children:Object(A.jsxs)(ue.a,{variant:"dense",sx:{gap:"10px"},children:[Object(A.jsx)("img",{src:Oe,alt:"logo",style:{height:"2.5rem"}}),Object(A.jsx)(w.a,{variant:"h5",color:"inherit",component:"div",sx:{flexGrow:1,fontSize:{xs:"10px",md:"inherit"}},children:"Smart office management"}),Object(A.jsx)(u.a,{size:"large",color:"inherit",children:Object(A.jsx)(le.a,{})})]})})},he=n(94),fe=n(20),pe=n(266),ke=n(254),me=function(){var e=Object(a.useState)(!1),t=Object(o.a)(e,2),n=t[0],c=t[1],r=Object(a.useState)(!1),s=Object(o.a)(r,2),i=s[0],d=s[1],u=Object(a.useState)(1),b=Object(o.a)(u,2),l=b[0],O=b[1],k=function(){var e=Object(h.a)(x.a.mark((function e(){var t,n,a;return x.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return c(!0),e.prev=1,e.next=4,fetch("".concat("https://ordina-smartdesk-api.azurewebsites.net/","api/desk/list"));case 4:return t=e.sent,e.next=7,t.json();case 7:if(n=e.sent,a=n.deskList,Array.isArray(a)){e.next=11;break}throw new Error("No desks in response");case 11:e.next=17;break;case 13:e.prev=13,e.t0=e.catch(1),console.error(e.t0),d(!0);case 17:c(!1);case 18:case"end":return e.stop()}}),e,null,[[1,13]])})));return function(){return e.apply(this,arguments)}}();Object(a.useEffect)((function(){k()}),[]);return Object(A.jsxs)(j.a,{sx:{flexGrow:1,p:{xs:1,md:3},pt:{xs:3,md:3}},children:[n&&Object(A.jsx)(pe.a,{}),Object(A.jsxs)(f.a,{elevation:6,className:"basecard",sx:{width:{xs:"100%",md:"900px"}},children:[Object(A.jsx)(ae.a,{title:"Smart Office Management",subheader:"Ordina"}),Object(A.jsxs)(p.a,{children:[i&&Object(A.jsx)(_.a,{severity:"error",children:"Error: API not available or failing!"}),Object(A.jsx)(w.a,{variant:"h6",gutterBottom:!0,children:"Booking a desk"}),Object(A.jsx)(w.a,{gutterBottom:!0,children:"Here you can book a desk for you and your team. Keep in mind ..."}),Object(A.jsx)(w.a,{variant:"h6",gutterBottom:!0,children:"Checking in"}),Object(A.jsx)(w.a,{children:"To check in you can scan the QR code on the desk or type in the desk number below. Keep in mind ..."}),Object(A.jsx)(z.a,{label:"Desk number",id:"outlined-start-adornment",sx:{m:1,width:"25ch"},InputProps:{startAdornment:Object(A.jsx)(ke.a,{position:"start",children:"B2."})},value:l,onChange:function(e){var t=parseInt(e.target.value,10);isNaN(t)?console.error("Error: not a number, might be an intermediate value"):O(t)},type:"number"})]}),!i&&Object(A.jsxs)(y.a,{children:[Object(A.jsx)(C.a,{component:"a",href:"/desks/book",children:"Make a new booking"}),Object(A.jsx)(C.a,{component:"a",href:"".concat("/desks/checkin/?b2.").concat(l),color:"secondary",children:"".concat("Check in at desk b2.").concat(l)})]})]})]})},ve=n(229),ge=n(125),we=Object(ge.a)({palette:{primary:{main:"#f58220",light:"#e1e1e1",dark:"#c46819"},secondary:{main:"#007f92",light:"#3da4bf",dark:"#58595b"}}});n(161);var ye=function(){return Object(A.jsx)("div",{className:"App",children:Object(A.jsx)(i.a,{theme:we,children:Object(A.jsxs)(he.a,{children:[Object(A.jsx)(ve.a,{}),Object(A.jsx)(xe,{}),Object(A.jsxs)(fe.c,{children:[Object(A.jsx)(fe.a,{path:"/desks/book",component:ne}),Object(A.jsx)(fe.a,{path:"/desks/checkin",component:je}),Object(A.jsx)(fe.a,{component:me})]})]})})})},Ce=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,267)).then((function(t){var n=t.getCLS,a=t.getFID,c=t.getFCP,r=t.getLCP,s=t.getTTFB;n(e),a(e),c(e),r(e),s(e)}))};s.a.render(Object(A.jsx)(c.a.StrictMode,{children:Object(A.jsx)(he.a,{children:Object(A.jsx)(ye,{})})}),document.getElementById("root")),Ce()}},[[166,1,2]]]);
//# sourceMappingURL=main.76c486c3.chunk.js.map